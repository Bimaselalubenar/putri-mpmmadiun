<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Putri Parwitasari | Buat janji temu</title>
    <meta name="twitter:title" content="Putri Parwitasari | Buat janji temu">
    <meta name="description" content="MPM Motor Madiun menyediakan berbagai pilihan sepeda motor Honda terbaru dengan layanan terbaik untuk pelanggan di Kota Madiun. Dapatkan penawaran spesial dan layanan terpercaya bersama Putri Parwitasari, dealer resmi Honda di Madiun.">
    <meta name="twitter:description" content="MPM Motor Madiun menyediakan berbagai pilihan sepeda motor Honda terbaru dengan layanan terbaik untuk pelanggan di Kota Madiun. Dapatkan penawaran spesial dan layanan terpercaya bersama Putri Parwitasari, dealer resmi Honda di Madiun.">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins&amp;display=swap">
    <link rel="stylesheet" href="assets/css/master.css">
<meta name="keywords" content="Honda Madiun, Dealer Honda Madiun, MPM Motor Madiun, Sepeda Motor Honda Madiun, Motor Honda terbaru Madiun, Putri Parwitasari Honda, Penjualan Motor Honda Madiun, Kredit Motor Honda Madiun">
</head>

<body style="font-family: 'Poppins';">
    <nav class="navbar navbar-expand-md navbar-shrink" id="mainNav" style="padding: 17px 0px;padding-top: 16px;padding-bottom: 16px;">
        <div class="container"><a class="navbar-brand d-flex align-items-center" href="/" style="margin-right: 0px;padding-top: 0px;padding-bottom: 0px;"><img src="assets/img/image/MPM.png" style="height: auto;width: 71px;"></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-1"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item d-md-flex d-lg-flex d-xl-flex d-xxl-flex"><a class="nav-link active" href="Janji-temu.html" style="padding-right: 16px;padding-left: 16px;">Janji Temu</a>
                        <div class="nav-item dropdown" href="Janji-temu.html" style="padding-top: 8px;padding-right: 16px;padding-bottom: 8px;padding-left: 16px;"><a class="dropdown-toggle" aria-expanded="false" data-bs-toggle="dropdown" href="#">Lainnya&nbsp;</a>
                            <div class="dropdown-menu"><a class="dropdown-item" href="index.html">Simulasi Kredit</a></div>
                        </div>
                    </li>
                </ul><a class="btn btndefault" role="button" href="https://bit.ly/putri-mpm-motor" target="_blank" style="margin-bottom: 0px;">Hubungi Putri</a>
            </div>
        </div>
    </nav>
    <div class="card d-flex justify-content-md-center align-items-md-center justify-content-lg-center align-items-lg-center">
        <div class="card-body text-center d-flex flex-column align-items-center" style="z-index: 2;width: 100%;max-width: 600px;padding-top: 108px;padding-bottom: 0px;padding-right: 0px;padding-left: 0px;"><img style="object-fit: cover;margin-bottom: 25px;border-radius: 50%;height: auto;width: 125px;border: 5px solid rgb(255,255,255);box-shadow: 0px 4px 6px 1px rgba(45,45,45,0.14);" src="assets/img/image/putri.webp">
            <p style="font-size: 16px;margin-bottom: 0px;"><strong>Putri | MPM Motor</strong></p>
            <p style="font-size: 12px;margin-bottom: 0px;">Solusi Motor Honda Terbaik untuk Anda!</p>
            <div style="width: 100%;margin-top: 16px;margin-bottom: 16px;">
                <form class="text-start d-flex flex-column" id="appt_appointmentForm" style="width: 100%;padding-top: 16px;padding-right: 16px;padding-left: 16px;padding-bottom: 60px;background: #dadada;color: var(--bs-emphasis-color);border-top-left-radius: 16px;border-top-right-radius: 16px;"><label class="form-label" for="appt_name" style="font-weight: bold;font-size: 20px;text-align: center;background: var(--bs-body-bg);padding-top: 6px;padding-bottom: 6px;box-shadow: 0px 3px 6px 1px rgba(0,0,0,0.21);border-radius: 10px;margin-bottom: 23px;">Isi formulir berikut untuk menentukan janji temu</label><label class="form-label" for="appt_name" style="font-weight: bold;">Nama</label><input class="form-control" type="text" id="appt_name" style="margin-bottom: 10px;" required="" placeholder="Nama" name="name"><label class="form-label" for="appt_whatsapp" style="font-weight: bold;">Nomor WhatsApp</label><input class="form-control" type="number" id="appt_whatsapp" style="margin-bottom: 10px;" required="" placeholder="Nomor WhatsApp" name="whatsapp"><label class="form-label" for="appt_jenisMotor" style="font-weight: bold;">Pilih jenis kendaraan</label><select class="form-select" id="appt_jenisMotor" name="jenisMotor" style="margin-bottom: 10px;" required="" value="Pilih Motor"></select><label class="form-label" for="appt_tipeMotor" style="font-weight: bold;">Pilih tipe motor</label><select class="form-select" id="appt_tipeMotor" name="tipeMotor" style="margin-bottom: 10px;" required="" value="Pilih tipe motor"></select><label class="form-label" for="appt_dp" style="font-weight: bold;">Pilih uang muka</label><select class="form-select" id="appt_dp" name="dp" style="margin-bottom: 10px;" required="" value="Pilih uang muka"></select><label class="form-label" for="appt_date" style="font-weight: bold;">Pilih tanggal janji temu</label><input class="form-control" id="appt_date" type="date" name="date" style="margin-bottom: 10px;"><label class="form-label" for="appt_date" style="font-weight: bold;">Pilih waktu</label><input class="form-control" id="appt_time" name="time" style="margin-bottom: 10px;" required="" value="Pilih uang muka" type="time">
                    <div class="form-check" style="margin-bottom: 10px;"><input class="form-check-input" type="checkbox" id="formCheck-2" required=""><label class="form-check-label" for="formCheck-2">Setuju dengan pilihan di atas</label></div><button class="btn btn-success" type="button" onclick="sendWhatsAppMessage()">Buat Janji Temu</button>
                    <div id="appt_loading" style="display: none;width: 100%;margin-top: 10px;text-align: center;"><label class="form-label" for="appt_date">Wait..</label></div><script>
    const API_KEY = 'AIzaSyAb0xa2ldevqx7bwRom_Pi9-nrnZVzOL1I'; // Replace with your actual API Key
    const SPREADSHEET_ID = '1K4H-raZg4uqUJCYt2C1s9A1mpHYWk7WM4-HFVRxn4-w'; // Replace with your Spreadsheet ID
    const SHEET_NAME = 'Sheet1'; // Replace with the actual sheet name

    const SHEETS_URL = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;

    let kreditData = [];

    // Fetch data from Google Sheets
    async function loadData() {
        try {
            const response = await fetch(SHEETS_URL);
            const data = await response.json();

            // Process data and transform to array of objects
            const rows = data.values;
            const headers = rows[0];
            kreditData = rows.slice(1).map(row => {
                let entry = {};
                headers.forEach((header, index) => {
                    entry[header] = row[index];
                });
                return entry;
            });

            populateJenisMotor();
        } catch (error) {
            console.error("Error fetching data:", error);
        }
    }

    // Populate "Jenis Motor" dropdown
    function populateJenisMotor() {
        const jenisMotorSelect = document.getElementById("appt_jenisMotor");
        const uniqueJenisMotor = [...new Set(kreditData.map(item => item['Jenis Motor']))];
        uniqueJenisMotor.forEach(jenis => {
            let option = document.createElement("option");
            option.value = jenis;
            option.textContent = jenis;
            jenisMotorSelect.appendChild(option);
        });
    }

    // Event listeners for dropdown dependencies
    document.getElementById("appt_jenisMotor").addEventListener("change", function() {
        const selectedJenis = this.value;
        const tipeMotorSelect = document.getElementById("appt_tipeMotor");
        tipeMotorSelect.disabled = !selectedJenis;
        
        tipeMotorSelect.innerHTML = ""; // Clear previous options

        const filteredTipeMotor = [...new Set(kreditData.filter(item => item['Jenis Motor'] === selectedJenis).map(item => item['Tipe Motor']))];
        filteredTipeMotor.forEach(tipe => {
            let option = document.createElement("option");
            option.value = tipe;
            option.textContent = tipe;
            tipeMotorSelect.appendChild(option);
        });

        // Automatically trigger 'tipeMotor' selection if only one option exists
        if (filteredTipeMotor.length === 1) {
            tipeMotorSelect.value = filteredTipeMotor[0];
            tipeMotorSelect.dispatchEvent(new Event("change"));
        }
    });

    document.getElementById("appt_tipeMotor").addEventListener("change", function() {
        const selectedJenis = document.getElementById("appt_jenisMotor").value;
        const selectedTipe = this.value;
        const dpSelect = document.getElementById("appt_dp");
        dpSelect.disabled = !selectedTipe;
        
        dpSelect.innerHTML = ""; // Clear previous options

        const filteredDP = [...new Set(
            kreditData
                .filter(item => item['Jenis Motor'] === selectedJenis && item['Tipe Motor'] === selectedTipe)
                .map(item => item['Uang Muka'])
        )];
        
        filteredDP.forEach(dp => {
            let option = document.createElement("option");
            option.value = dp;
            option.textContent = parseInt(dp).toLocaleString('id-ID', { style: 'currency', currency: 'IDR' });
            dpSelect.appendChild(option);
        });

        // Automatically trigger 'dp' selection if only one option exists
        if (filteredDP.length === 1) {
            dpSelect.value = filteredDP[0];
        }
    });

    // Send message to WhatsApp with selected details
    function sendWhatsAppMessage() {
        // Get form values
        const name = document.getElementById("appt_name").value;
        const whatsapp = document.getElementById("appt_whatsapp").value;
        const motorType = document.getElementById("appt_jenisMotor").value;
        const motorModel = document.getElementById("appt_tipeMotor").value;
        const dp = document.getElementById("appt_dp").selectedOptions[0].textContent;
        const date = document.getElementById("appt_date").value;
        const time = document.getElementById("appt_time").value;

        // Create the message content
        const message = `Halo kak,\nsaya ingin melakukan janji temu untuk kak Putri,\n` +
                        `Nama saya : ${name}\n` +
                        `Nomor WhatsApp : ${whatsapp}\n` +
                        `Ingin melakukan pembelian motor : ${motorType}\n` +
                        `Tipe motor : ${motorModel}\n` +
                        `Dengan DP : ${dp}\n\n` +
                        `Saya ingin menemui pada tanggal ${date} jam ${time} di MPM Motor Madiun\n\n` +
                        `Terima kasih\n` +
                        `engine : www.bimaselalubenar.my.id`;

        // Open WhatsApp with the message content
        const whatsappUrl = `https://wa.me/6282233073147?text=${encodeURIComponent(message)}`;
        window.open(whatsappUrl, '_blank');
    }

    // Load data on page load
    window.onload = loadData;
</script>
                </form>
            </div>
        </div>
        <div class="card-body text-center d-flex flex-column align-items-center" style="z-index: 1;width: 100%;max-width: 600px;padding: 0px;padding-top: 0px;padding-bottom: 0px;position: absolute;top: 0px;height: 170px;border-bottom-right-radius: 16px;border-bottom-left-radius: 16px;overflow: hidden;"><img style="object-fit: cover;width: 100%;height: 100%;" src="https://static.republika.co.id/uploads/images/inpicture_slide/mpm_200331182213-938.jpg"></div>
    </div>
    <footer class="bg-primary-gradient">
        <div class="container py-4 py-lg-5">
            <div class="row justify-content-center">
                <div class="col-sm-4 col-md-3 text-center text-lg-start d-flex flex-column">
                    <h3 class="fs-6 fw-bold">Profil</h3>
                    <ul class="list-unstyled">
                        <li><a href="#">Putri MPM Madiun</a></li>
                        <li><a href="#">Simulasi Kredit</a></li>
                    </ul>
                </div>
                <div class="col-sm-4 col-md-3 text-center text-lg-start d-flex flex-column">
                    <h3 class="fs-6 fw-bold">Blank</h3>
                    <ul class="list-unstyled">
                        <li><a href="#">-</a></li>
                        <li><a href="#">-</a></li>
                        <li><a href="#">-</a></li>
                    </ul>
                </div>
                <div class="col-sm-4 col-md-3 text-center text-lg-start d-flex flex-column">
                    <h3 class="fs-6 fw-bold">Blank</h3>
                    <ul class="list-unstyled">
                        <li><a href="#">-</a></li>
                        <li><a href="#">-</a></li>
                        <li><a href="#">-</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 text-center text-lg-start d-flex flex-column align-items-center order-first align-items-lg-start order-lg-last">
                    <div class="fw-bold d-flex align-items-center mb-2"><img src="assets/img/image/MPM.png" style="height: auto;width: 71px;"></div>
                    <p class="text-muted">MPM Madiun</p>
                </div>
            </div>
            <hr>
            <div class="text-muted d-flex justify-content-between align-items-center justify-content-xxl-center pt-3" style="text-align: center;">
                <p class="mb-0">©️2024 | Putri MPM Madiun<br><em>Powered by : </em><a href="https://bimaselalubenar.my.id/" target="_blank"><em><span style="color: rgb(51, 96, 255);">bimaselalubenar</span></em></a></p>
            </div>
        </div>
    </footer>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bold-and-bright.js"></script>
</body>

</html>